<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ğŸ“– Ø§Ø®ØªØ¨Ø§Ø± Ø­ÙØ¸ Ø§Ù„Ù†ØµÙˆØµ â€“ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</title>
<style>
  :root{
    --bg:#f7f7fb; --fg:#1f2937; --muted:#6b7280; --brand:#2b3a55; --accent:#e3b04b;
    --ok:#16a34a; --bad:#ef4444; --link:#2563eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:"Tajawal","Segoe UI",system-ui,-apple-system,sans-serif}
  header{padding:24px 16px;text-align:center}
  h1{margin:0 0 6px;font-size:28px;color:var(--brand)}
  .sub{color:var(--muted);font-size:15px}
  .wrap{max-width:900px;margin:0 auto;padding:0 16px 28px}
  .card{background:#fff;border-radius:14px;box-shadow:0 8px 24px rgba(0,0,0,.06);padding:20px;margin:14px auto}
  textarea{width:100%;min-height:160px;resize:vertical;direction:rtl;border:1px solid #e5e7eb;border-radius:10px;padding:12px;font-size:16px}
  .row{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  .field{background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;display:flex;align-items:center;gap:10px}
  .field label{white-space:nowrap;color:var(--muted);font-size:14px}
  .field input{width:90px;text-align:center;border:1px solid #e5e7eb;border-radius:8px;padding:6px 8px;font-size:15px}
  .actions{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap}
  button{border:none;border-radius:10px;padding:10px 16px;font-size:16px;cursor:pointer}
  .primary{background:var(--brand);color:#fff}
  .ghost{background:#fff;border:1px solid #e5e7eb;color:var(--fg)}
  .accent{background:var(--accent);}
  .ok{background:var(--ok);color:#fff}
  .bad{background:var(--bad);color:#fff}
  .center{text-align:center}
  .big{font-size:20px}
  .muted{color:var(--muted)}
  .timer{font-weight:700;color:var(--brand);font-size:18px;margin-bottom:8px}
  .q-meta{font-size:14px;color:var(--muted);margin-top:6px}
  .hidden-ellipses{color:#9ca3af}
  .grid{display:grid;gap:10px}
  #startView, #quizView, #resultView{display:none}
  #quizText{line-height:2}
</style>
</head>
<body>

<header>
  <h1>ğŸ“– Ø§Ø®ØªØ¨Ø§Ø± Ø­ÙØ¸ Ø§Ù„Ù†ØµÙˆØµ</h1>
  <div class="sub">Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù… <b>Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</b> â€“ Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù…Ø¬ÙŠØ¯ÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø¨Ø§Ù„Ù‚Ø·ÙŠÙ</div>
</header>

<div class="wrap">

  <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
  <section id="startView" class="card">
    <div class="grid">
      <label class="muted">Ø£Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ø®ØªØ¨Ø§Ø±Ù‡:</label>
      <textarea id="inputText" placeholder="Ø¶Ø¹ Ù‡Ù†Ø§ Ø§Ù„Ø¢ÙŠØ§Øª Ø£Ùˆ Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø¯Ø¨ÙŠ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù†Ù‡..."></textarea>

      <div class="row">
        <div class="field">
          <label for="prefix">Ø¹Ø¯Ø¯ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ø¤Ø§Ù„</label>
          <input id="prefix" type="number" value="10" min="1" />
        </div>
        <div class="field">
          <label for="suffix">Ø¹Ø¯Ø¯ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</label>
          <input id="suffix" type="number" value="5" min="1" />
        </div>
        <div class="field">
          <label for="cardsCount">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</label>
          <input id="cardsCount" type="number" value="10" min="1" />
        </div>
        <div class="field">
          <label for="timerSec">Ù…Ø¯Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ â±ï¸</label>
          <input id="timerSec" type="number" value="20" min="5" />
        </div>
      </div>

      <div class="actions">
        <button id="startBtn" class="primary">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
      </div>
    </div>
  </section>

  <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ -->
  <section id="quizView" class="card center">
    <div id="timer" class="timer">â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span id="remaining">--</span> Ø«Ø§Ù†ÙŠØ©</div>
    <div id="quizText" class="big"></div>
    <div class="q-meta" id="progressText"></div>

    <div class="actions" style="justify-content:center;margin-top:16px;">
      <button id="flipBtn" class="accent">Ø£Ø¸Ù‡Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
    </div>

    <div id="answerArea" style="display:none; margin-top:10px;">
      <div id="answerText" class="big"></div>
      <div class="actions" style="justify-content:center;margin-top:12px;">
        <button id="correctBtn" class="ok">âœ… ØµÙˆØ§Ø¨</button>
        <button id="wrongBtn" class="bad">âŒ Ø®Ø·Ø£</button>
      </div>
    </div>
  </section>

  <!-- Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
  <section id="resultView" class="card center">
    <h2 id="finalScore" class="big" style="margin-top:0"></h2>
    <div class="muted" style="margin-bottom:14px;">ØªÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­ â€“ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</div>
    <div class="actions" style="justify-content:center;">
      <button id="restartBtn" class="ghost">ğŸ” Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
  </section>

</div>

<script>
/* Ø¹Ù†Ø§ØµØ± DOM */
const startView    = document.getElementById('startView');
const quizView     = document.getElementById('quizView');
const resultView   = document.getElementById('resultView');

const inputTextEl  = document.getElementById('inputText');
const prefixEl     = document.getElementById('prefix');
const suffixEl     = document.getElementById('suffix');
const cardsEl      = document.getElementById('cardsCount');
const timerSecEl   = document.getElementById('timerSec');

const startBtn     = document.getElementById('startBtn');

const quizText     = document.getElementById('quizText');
const progressText = document.getElementById('progressText');
const remainingEl  = document.getElementById('remaining');
const flipBtn      = document.getElementById('flipBtn');

const answerArea   = document.getElementById('answerArea');
const answerText   = document.getElementById('answerText');
const correctBtn   = document.getElementById('correctBtn');
const wrongBtn     = document.getElementById('wrongBtn');

const finalScore   = document.getElementById('finalScore');
const restartBtn   = document.getElementById('restartBtn');

/* Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
let words = [];
let prefix = 10, suffix = 5, totalCards = 10, timerSeconds = 20;
let indices = [];       // Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
let current = 0;        // Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
let correct = 0;        // Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©

/* Ø§Ù„Ù…Ø¤Ù‚Ù‘Øª */
let remaining = 0;
let intervalId = null;
let paused = false;     // ÙŠÙˆÙ‚ÙÙ Ø¹Ù†Ø¯ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©

function show(view){
  startView.style.display  = (view==='start')  ? 'block' : 'none';
  quizView.style.display   = (view==='quiz')   ? 'block' : 'none';
  resultView.style.display = (view==='result') ? 'block' : 'none';
}

/* Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
show('start');

/* Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ */
startBtn.onclick = () => {
  const text = (inputTextEl.value || '').trim();
  if (!text) { alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Øµ Ø£ÙˆÙ„Ù‹Ø§.'); return; }

  words = text.split(/\s+/);
  prefix = parseInt(prefixEl.value || '10', 10);
  suffix = parseInt(suffixEl.value || '5', 10);
  totalCards = parseInt(cardsEl.value || '10', 10);
  timerSeconds = parseInt(timerSecEl.value || '20', 10);

  if (words.length < prefix + suffix + 1) {
    alert('Ø§Ù„Ù†Øµ Ù‚ØµÙŠØ± Ø¬Ø¯Ù‹Ø§ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.');
    return;
  }

  // ØªÙˆÙ„ÙŠØ¯ Ø¨Ø¯Ø§ÙŠØ§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø¯ÙˆÙ† ØªØ¬Ø§ÙˆØ² Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù†Øµ
  indices = [];
  const maxStart = words.length - (prefix + suffix);
  const need = Math.min(totalCards, Math.max(1, maxStart));
  while (indices.length < need) {
    const r = Math.floor(Math.random() * maxStart);
    if (!indices.includes(r)) indices.push(r);
  }

  current = 0; correct = 0;
  show('quiz');
  renderCard();
};

/* Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ */
function renderCard(){
  // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù†Øµ
  const i = indices[current];
  const head = words.slice(i, i + prefix).join(' ');
  const tail = words.slice(i + prefix, i + prefix + suffix).join(' ');

  // Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„
  quizText.innerHTML = `<b>${head}</b> <span class="hidden-ellipses">â€¦</span>`;
  // Ù†Øµ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
  answerText.textContent = tail;

  // ÙˆØ§Ø¬Ù‡Ø©
  answerArea.style.display = 'none';
  progressText.textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${current + 1} Ù…Ù† ${indices.length}`;

  // Ù…Ø¤Ù‚Ù‘Øª
  stopTimer();
  remaining = timerSeconds;
  paused = false;
  updateTimerUI();
  startTimer();
}

/* ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Ù‘Øª */
function startTimer(){
  stopTimer();
  intervalId = setInterval(() => {
    if (paused) return;
    remaining--;
    if (remaining <= 0) {
      remaining = 0;
      updateTimerUI();
      // ÙŠÙ†ØªÙ‚Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
      nextCard();
      return;
    }
    updateTimerUI();
  }, 1000);
}

/* Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Ù‘Øª */
function stopTimer(){
  if (intervalId) {
    clearInterval(intervalId);
    intervalId = null;
  }
}

/* ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¤Ù‚Ù‘Øª */
function updateTimerUI(){
  remainingEl.textContent = remaining.toString();
}

/* Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© */
flipBtn.onclick = () => {
  answerArea.style.display = 'block';
  paused = true; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø¯Ù‘ Ø£Ø«Ù†Ø§Ø¡ Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
};

/* ØªØ³Ø¬ÙŠÙ„ ØµÙˆØ§Ø¨/Ø®Ø·Ø£ */
correctBtn.onclick = () => { correct++; nextCard(); };
wrongBtn.onclick   = () => { nextCard(); };

/* Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø£Ùˆ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© */
function nextCard(){
  stopTimer();
  current++;
  if (current < indices.length) {
    renderCard();
  } else {
    finish();
  }
}

/* Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© */
function finish(){
  show('result');
  finalScore.textContent = `Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${correct} Ù…Ù† ${indices.length}`;
}

/* Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± */
restartBtn.onclick = () => {
  show('start');
};
</script>

</body>
</html>
